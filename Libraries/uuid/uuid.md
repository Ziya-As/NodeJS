# `uuid`

- [`uuid`](#uuid)
  - [`uuid` and a Simple Usage of It](#uuid-and-a-simple-usage-of-it)
  - [Versions of UUID](#versions-of-uuid)
  - [Various functions from `uuid` package](#various-functions-from-uuid-package)
    - [Parsing a UUID string with `uuid` package](#parsing-a-uuid-string-with-uuid-package)
    - [Validating a UUID with `uuid` package](#validating-a-uuid-with-uuid-package)
    - [Generating a version 1 UUID (timestamp-based) with `uuid` package](#generating-a-version-1-uuid-timestamp-based-with-uuid-package)
      - [Custom UUID V1 and the options object](#custom-uuid-v1-and-the-options-object)
    - [Generating a version 3 UUID (name-based) with `uuid` package:](#generating-a-version-3-uuid-name-based-with-uuid-package)
    - [Generating a version 5 UUID (name-based) with `uuid` package](#generating-a-version-5-uuid-name-based-with-uuid-package)
    - [Generating NIL UUID with `uuid` package](#generating-nil-uuid-with-uuid-package)
  - [API Example](#api-example)

<hr>

## `uuid` and a Simple Usage of It

User identity and security are critical factors for building modern applications, and many measures are in place to ensure the security of users’ identities.

One method of user identification on the internet is UUIDs, or universally unique identifiers. Similar to Microsoft’s GUIDs (globally unique identifiers), UUIDs are unique 128-bit values popularly used to uniquely identify entities on the internet.

The uuid package provides functionality for generating cryptographically secure standard UUIDs with support for versions 1, 3, 4, and 5 UUIDs, as well as cross-platform support for NodeJS, CommonJS, Webpack, React Native Expo, and more.

The `uuid` package is an external dependency, so you’ll have to install the package.

```
npm install uuid
```

After installing the `uuid` package, import the package into your JavaScript file.

```js
const uuid = require("uuid");
```

Here’s an example of generating a v4 UUID with the `uuid` package. We use `v4`, because it's more preferable due to less chance of replication:

```js
const uuid4 = uuid.v4();
console.log(uuid4);
```

<hr>

## Versions of UUID

There are 5 different versions of UUIDs, excluding the Nil UUID version, which is a special case of UUID where all its bytes are set to 0, and most contain some variants that allow for special cases specific to vendors like Microsoft. Version 1 and 2 use time-based sources (a 60 bit timestamp sourced from the system clock) for its randomness. Versions 1 and 2 are effectively the same, except in the latter version the least significant bits of the clock sequence are replaced with an identifier specific to the system. Most implementations, because of this and other reasons, omit version 2.

Versions 3 and 5 are generated by hashing a name or namespace identifier and using the resultant hash, MD5 or SHA-1 respectively, as the source of uniqueness instead of the time-based sources like in versions 1 and 2. They are meant for generating UUIDs from names that are drawn from, and unique within, some name space. The concept of name and name space should be broadly construed, and not limited to textual names. For example, some name spaces are the domain name system, URLs, ISO Object IDs (OIDs), X.500 Distinguished Names (DNs), and reserved words in a programming language.

Version 4 uses random or pseudo-random sources rather than time or namespace-derived sources for its uniqueness. This results in unique identifiers that cannot be replayed and have extremely low change of being guessed. Given such small chance of collision, v4's main use case is when you need to ensure that the generated identifier is truly unique across your entire application (and likely around the globe)

<hr>

We always need to have an exception handling code in place to smoothly tackle collisions if they ever occur.

<hr>

## Various functions from `uuid` package

The `uuid` package in NodeJS provides several commonly used functions for working with UUIDs. Here are a few examples:

### Parsing a UUID string with `uuid` package

`uuid.parse()` method converts UUID string to array of bytes. Here's an example:

```javascript
const uuid = require("uuid");

const uuidString = "1e1c7d90-62a5-4e60-ba75-380b40249a54";
const parsedUuid = uuid.parse(uuidString);

console.log(parsedUuid);
```

Output:

```
{
  0: 30,
  1: 28,
  2: 125,
  3: 144,
  4: 98,
  5: 165,
  6: 78,
  7: 96,
  8: 186,
  9: 117,
  10: 56,
  11: 11,
  12: 64,
  13: 36,
  14: 154,
  15: 84,
  version: 4,
  variant: 2
}
4
2
```

In this example, we use the `uuid.parse()` function to parse the UUID string and obtain a parsed UUID object. We can access the individual components of the UUID using numeric indices (0-15).

### Validating a UUID with `uuid` package

To validate whether a given string is a valid UUID, you can use the `uuid.validate()` function provided by the `uuid` package. Here's an example:

```javascript
const uuid = require("uuid");

const uuidString = "1e1c7d90-62a5-4e60-ba75-380b40249a54";
const isValid = uuid.validate(uuidString);

console.log(isValid);
```

Output:

```
true
```

The method returns `true` if the UUID is valid and `false` otherwise.

### Generating a version 1 UUID (timestamp-based) with `uuid` package

To generate a version 1 UUID using the `uuid` package, you can use the `uuid.v1()` function directly without destructuring. Here's an example:

```javascript
const uuid = require("uuid");

const uuidv1 = uuid.v1();
console.log(uuidv1);
```

Output:

```
3667c5a0-c135-11eb-9a03-4fb8ef7ebe16
```

In this example, we use the `uuid.v1()` function to generate a version 1 UUID based on the timestamp and MAC address.

#### Custom UUID V1 and the options object

The `uuid` package allows you to generate UUIDs with custom options using the `uuid.v1()`. Some common options include `node`, `clockseq`, and `msecs`. Here's an example:

```js
const uuid = require("uuid");

const options = {
  node: [0x01, 0x23, 0x45, 0x67, 0x89, 0xab],
  clockseq: 0x1234,
  msecs: new Date("2023-05-12").getTime(),
};

const customUUIDv1 = uuid.v1(options);
console.log(customUUIDv1);
```

The options object that is accepted by some UUID functions in the `uuid` package allows you to customize the generation of UUIDs. Let's explore the properties commonly used in the options object:

1. `node` property:

The `node` property allows you to specify a custom node identifier for generating version 1 UUIDs. A node identifier is a 6-byte (48-bit) value typically representing the MAC address of the network interface card (NIC). By default, the `uuid` package uses the MAC address of the machine running the code. However, you can provide your own custom node identifier as an array of 6 bytes (in hexadecimal format) to generate UUIDs with a specific node identifier. Here's an example:

```javascript
const uuid = require("uuid");

const options = {
  node: [0x01, 0x23, 0x45, 0x67, 0x89, 0xab],
};

const customUUIDv1 = uuid.v1(options);
console.log(customUUIDv1);
```

Output:

```
01234567-89ab-1xxx-xxxxxxxxxxxx
```

The x's in the output represent the dynamically generated portions of the UUID.

2. `clockseq` property:

The `clockseq` property allows you to set a custom clock sequence value for generating version 1 UUIDs. The clock sequence is a 14-bit value used to prevent conflicts when generating multiple UUIDs within the same timestamp. By default, the `uuid` package generates a random clock sequence value. However, you can provide your own custom clock sequence value (a 16-bit integer) to generate UUIDs with a specific clock sequence. Here's an example:

```javascript
const uuid = require("uuid");

const options = {
  clockseq: 0x1234,
};

const customUUIDv1 = uuid.v1(options);
console.log(customUUIDv1);
```

Output:

```
xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx
```

The x's and y in the output represent the dynamically generated portions of the UUID.

3. `msecs` property:

The `msecs` property allows you to set a custom timestamp (in milliseconds) for generating version 1 UUIDs. The timestamp represents the number of milliseconds since the UTC epoch (January 1, 1970). By default, the `uuid` package uses the current system time. However, you can provide your own custom timestamp as a `Date` object or a Unix timestamp (milliseconds since the epoch) to generate UUIDs with a specific timestamp. Here's an example:

```javascript
const uuid = require("uuid");

const options = {
  msecs: new Date("2023-05-12").getTime(),
};

const customUUIDv1 = uuid.v1(options);
console.log(customUUIDv1);
```

Output:

```
xxxxxxxx-xxxx-1xxx-yxxx-xxxxxxxxxxxx
```

In this example, we set the `msecs` property in the options object to the timestamp of May 12, 2023. The x's and y in the output represent the dynamically generated portions of the UUID.

These are the commonly used properties in the options object for customizing the generation of version 1 UUIDs in the `uuid` package. The specific behavior and effects of these properties may vary depending on the UUID version and the package implementation.

<hr>

### Generating a version 3 UUID (name-based) with `uuid` package:

The `uuid` package allows you to generate version 3 UUIDs, which are based on the MD5 hash of a namespace identifier and a name. Here's an example:

```javascript
const uuid = require("uuid");

const namespace = "1b4e28ba-2fa1-11d2-883f-0016d3cca427";
const name = "example.com";

const uuidv3 = uuid.v3(name, namespace);
console.log(uuidv3);
```

Output:

```
5a5baa80-8242-365e-9bf8-a8d4de6b6b79
```

### Generating a version 5 UUID (name-based) with `uuid` package

Similar to version 3 UUIDs, the `uuid` package allows you to generate version 5 UUIDs using SHA-1 hashing instead of MD5. Here's an example:

```javascript
const uuid = require("uuid");

const namespace = "1b4e28ba-2fa1-11d2-883f-0016d3cca427";
const name = "example.com";

const uuidv5 = uuid.v5(name, namespace);
console.log(uuidv5);
```

Output:

```
2ed6657d-e927-568b-95e1-2665a8aea6a2
```

### Generating NIL UUID with `uuid` package

The `uuid` package provides a function to generate a NIL UUID, which is a special UUID with all bits set to zero. Here's an example:

```javascript
const uuid = require("uuid");

const nilUuid = uuid.NIL;
console.log(nilUuid);
```

Output:

```
00000000-0000-0000-0000-000000000000
```

<hr>

## API Example

```js
const express = require("express");
const uuid = require("uuid");

const app = express();

// Route to generate and return a v4 UUID
app.get("/generate-uuid", (req, res) => {
  const randomUUIDv4 = uuid.v4();
  res.status(200).send(randomUUIDv4);
});

// Start the server
app.listen(3000, () => {
  console.log("Server started on port 3000");
});
```

<hr>
